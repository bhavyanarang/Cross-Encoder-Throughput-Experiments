# 04_backend_compiled

_torch.compile with inductor backend for kernel fusion on MPS_

**Timestamp:** 2025-12-26 02:18:26

**Model:** `cross-encoder/ms-marco-MiniLM-L-6-v2`

**Backend:** `compiled` | **Device:** `mps`

## Results Summary

| Batch | Conc | Pairs | Time(s) | Lat Avg | Lat P95 | Lat P99 | TP Avg | TP P95 |
|-------|------|-------|---------|---------|---------|---------|--------|--------|
| 32 | 1 | 3200 | 19.40 | 194.0ms | 174.6ms | 2277.9ms | 164.9 | 274.4 |

## Detailed Metrics

### Config 1: batch=32, concurrency=1

**Total:** 3200 pairs in 19.40s

#### Latency (ms)
| Metric | Value |
|--------|-------|
| Average | 194.02 |
| Min | 107.07 |
| Max | 3070.87 |
| Std Dev | 364.44 |
| P50 | 135.66 |
| P90 | 163.59 |
| P95 | 174.61 |
| P99 | 2277.85 |

#### Throughput (pairs/s)
| Metric | Value |
|--------|-------|
| Average | 164.92 |
| Min | 10.42 |
| Max | 298.86 |
| Std Dev | 44.89 |
| P50 | 235.89 |
| P90 | 267.36 |
| P95 | 274.36 |
| P99 | 283.51 |

#### Latency vs Throughput Analysis

| Latency Range | Avg Throughput | Min Throughput | Max Throughput | Count |
|---------------|----------------|----------------|----------------|-------|
| < 135.7ms (P50) | 257.76 | 236.75 | 298.86 | 50 |
| 135.7-147.5ms (P50-P75) | 227.52 | 217.02 | 235.03 | 25 |
| 147.5-163.6ms (P75-P90) | 207.04 | 196.13 | 216.88 | 15 |
| >= 163.6ms (P90+) | 136.27 | 10.42 | 191.02 | 10 |

**Correlation:** -0.777 (negative correlation expected: lower latency = higher throughput)

## Overall Summary

| Metric | Value | Config |
|--------|-------|--------|
| Best Throughput | 164.92 p/s | batch=32, conc=1 |
| Best Latency | 194.02ms | batch=32, conc=1 |
| Avg Throughput | 164.92 p/s | all configs |
| Avg Latency | 194.02ms | all configs |

## Dashboard Metrics Summary

| Metric | Avg | Min | Max | P50 | P95 |
|--------|-----|-----|-----|-----|-----|
| GPU Memory (MB) | 1191.2 | 1085.6 | 1271.6 | 1193.6 | 1271.6 |
| GPU Utilization (%) | 93.5 | 83.2 | 100.0 | 92.2 | 100.0 |
| CPU Usage (%) | 1.9 | 0.3 | 37.3 | 0.8 | 1.9 |
| Tokenization (ms) | 13.4 | 10.5 | 70.1 | 11.7 | 14.0 |
| Inference (ms) | 355.8 | 101.8 | 3571.6 | 123.4 | 2282.6 |
| Queue Wait (ms) | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
| Padding Waste (%) | 41.6 | 32.2 | 55.1 | 40.5 | 51.0 |

## Dashboard Time-Series Data

| Index | GPU Mem (MB) | GPU Util (%) | CPU (%) | Latency (ms) | Throughput | Tokenize (ms) | Inference (ms) | Queue (ms) | Padding (%) |
|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| 0 | 1085.6 | 100.0 | 0.5 | 3590.7 | 32 | 12.8 | 3571.6 | 0.0 | 37.1 |
| 1 | 1085.6 | 100.0 | 1.3 | 1855.0 | 64 | 11.2 | 107.0 | 0.0 | 37.1 |
| 2 | 1085.6 | 100.0 | 1.8 | 1277.0 | 96 | 12.1 | 108.0 | 0.0 | 37.1 |
| 3 | 1085.6 | 100.0 | 1.4 | 987.9 | 128 | 11.7 | 107.5 | 0.0 | 37.1 |
| 4 | 1085.6 | 100.0 | 1.6 | 814.3 | 160 | 11.2 | 107.8 | 0.0 | 37.1 |
| 5 | 1085.6 | 100.0 | 1.6 | 698.8 | 192 | 11.7 | 108.3 | 0.0 | 37.1 |
| 6 | 1085.6 | 100.0 | 37.3 | 3069.9 | 32 | 19.4 | 3048.1 | 0.0 | 40.2 |
| 7 | 1109.6 | 100.0 | 0.8 | 2268.9 | 32 | 70.1 | 2197.6 | 0.0 | 41.8 |
| 8 | 1135.6 | 100.0 | 0.3 | 1528.7 | 64 | 12.2 | 775.1 | 0.0 | 40.8 |
| 9 | 1135.6 | 100.0 | 1.2 | 1063.7 | 96 | 12.3 | 120.0 | 0.0 | 34.2 |
| 10 | 1135.6 | 100.0 | 1.3 | 352.7 | 96 | 11.4 | 123.8 | 0.0 | 39.4 |
| 11 | 1135.6 | 100.0 | 1.3 | 301.2 | 128 | 11.8 | 133.8 | 0.0 | 45.8 |
| 12 | 1163.6 | 100.0 | 1.4 | 271.0 | 160 | 12.8 | 136.3 | 0.0 | 47.2 |
| 13 | 1163.6 | 99.1 | 0.8 | 137.0 | 256 | 11.7 | 122.8 | 0.0 | 36.5 |
| 14 | 1163.6 | 88.3 | 0.6 | 138.9 | 224 | 12.2 | 139.7 | 0.0 | 44.6 |
| 15 | 1163.6 | 86.0 | 0.8 | 135.0 | 224 | 11.1 | 115.0 | 0.0 | 39.4 |
| 16 | 1193.6 | 91.3 | 0.8 | 126.2 | 256 | 10.9 | 103.9 | 0.0 | 39.1 |
| 17 | 1193.6 | 92.2 | 0.8 | 127.2 | 256 | 11.3 | 102.7 | 0.0 | 32.2 |
| 18 | 1193.6 | 91.1 | 0.6 | 142.7 | 224 | 13.4 | 159.3 | 0.0 | 44.2 |
| 19 | 1193.6 | 91.9 | 0.8 | 144.0 | 224 | 11.5 | 123.6 | 0.0 | 47.1 |
| 20 | 1261.6 | 83.4 | 0.7 | 131.3 | 224 | 11.1 | 114.0 | 0.0 | 44.5 |
| 21 | 1261.6 | 83.9 | 0.9 | 132.0 | 224 | 11.8 | 123.4 | 0.0 | 38.3 |
| 22 | 1261.6 | 100.0 | 0.7 | 138.2 | 256 | 11.2 | 125.9 | 0.0 | 40.5 |
| 23 | 1261.6 | 90.3 | 0.6 | 141.6 | 224 | 11.0 | 130.5 | 0.0 | 42.6 |
| 24 | 1261.6 | 83.2 | 0.8 | 131.0 | 224 | 10.6 | 104.0 | 0.0 | 37.0 |
| 25 | 1261.6 | 87.0 | 0.8 | 136.7 | 224 | 11.7 | 123.1 | 0.0 | 46.7 |
| 26 | 1271.6 | 91.1 | 0.8 | 142.9 | 224 | 11.6 | 108.1 | 0.0 | 35.7 |
| 27 | 1271.6 | 99.6 | 0.9 | 137.0 | 256 | 13.0 | 148.2 | 0.0 | 47.6 |
| 28 | 1271.6 | 89.3 | 0.7 | 140.5 | 224 | 12.3 | 114.2 | 0.0 | 34.3 |
| 29 | 1271.6 | 87.8 | 0.8 | 138.1 | 224 | 11.4 | 131.4 | 0.0 | 50.8 |
| 30 | 1235.6 | 91.1 | 0.7 | 142.8 | 224 | 12.7 | 153.4 | 0.0 | 55.1 |
| 31 | 1235.6 | 85.8 | 0.8 | 135.0 | 224 | 10.9 | 111.5 | 0.0 | 44.7 |
| 32 | 1235.6 | 90.8 | 0.9 | 125.5 | 256 | 11.4 | 134.3 | 0.0 | 52.7 |
| 33 | 1235.6 | 97.6 | 0.9 | 134.4 | 256 | 10.5 | 101.8 | 0.0 | 36.8 |
| 34 | 1235.6 | 87.7 | 0.7 | 137.8 | 224 | 10.6 | 114.7 | 0.0 | 41.1 |
| 35 | 1235.6 | 83.8 | 0.9 | 131.8 | 224 | 11.5 | 131.3 | 0.0 | 47.6 |
| 36 | 1235.6 | 95.5 | 0.9 | 131.8 | 256 | 10.9 | 109.9 | 0.0 | 37.6 |
| 37 | 1235.6 | 87.8 | 0.7 | 138.0 | 224 | 11.9 | 136.0 | 0.0 | 47.3 |
| 38 | 1235.6 | 92.3 | 2.6 | 144.8 | 224 | 12.7 | 148.6 | 0.0 | 45.5 |
