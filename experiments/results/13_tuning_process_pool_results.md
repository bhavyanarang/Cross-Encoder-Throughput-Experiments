# Tuning Process Pool (4x MPS + Compile)

_4 model replicas with torch.compile and process isolation_

**Timestamp:** 2025-12-26 02:25:37

**Model:** `cross-encoder/ms-marco-MiniLM-L-6-v2`

**Backend:** `mps` | **Device:** `mps`

**Dynamic Batching:** enabled (max_batch=256, timeout=200ms)

## Results Summary

| Batch | Conc | Pairs | Time(s) | Lat Avg | Lat P95 | Lat P99 | TP Avg | TP P95 |
|-------|------|-------|---------|---------|---------|---------|--------|--------|
| 32 | 1 | 3200 | 28.36 | 283.6ms | 299.1ms | 394.6ms | 112.8 | 123.6 |

## Detailed Metrics

### Config 1: batch=32, concurrency=1

**Total:** 3200 pairs in 28.36s

#### Latency (ms)
| Metric | Value |
|--------|-------|
| Average | 283.61 |
| Min | 255.50 |
| Max | 431.73 |
| Std Dev | 23.74 |
| P50 | 284.88 |
| P90 | 296.19 |
| P95 | 299.08 |
| P99 | 394.62 |

#### Throughput (pairs/s)
| Metric | Value |
|--------|-------|
| Average | 112.82 |
| Min | 74.12 |
| Max | 125.24 |
| Std Dev | 7.71 |
| P50 | 112.33 |
| P90 | 121.62 |
| P95 | 123.62 |
| P99 | 125.22 |

#### Latency vs Throughput Analysis

| Latency Range | Avg Throughput | Min Throughput | Max Throughput | Count |
|---------------|----------------|----------------|----------------|-------|
| < 284.9ms (P50) | 118.48 | 112.37 | 125.24 | 50 |
| 284.9-289.2ms (P50-P75) | 111.38 | 110.68 | 112.29 | 25 |
| 289.2-296.2ms (P75-P90) | 109.63 | 108.05 | 110.60 | 15 |
| >= 296.2ms (P90+) | 99.37 | 74.12 | 107.91 | 10 |

**Correlation:** -0.981 (negative correlation expected: lower latency = higher throughput)

## Overall Summary

| Metric | Value | Config |
|--------|-------|--------|
| Best Throughput | 112.82 p/s | batch=32, conc=1 |
| Best Latency | 283.61ms | batch=32, conc=1 |
| Avg Throughput | 112.82 p/s | all configs |
| Avg Latency | 283.61ms | all configs |

## Dashboard Metrics Summary

| Metric | Avg | Min | Max | P50 | P95 |
|--------|-----|-----|-----|-----|-----|
| GPU Memory (MB) | 1161.7 | 1087.6 | 1203.6 | 1177.6 | 1195.6 |
| GPU Utilization (%) | 23.7 | 12.1 | 36.2 | 23.2 | 29.9 |
| CPU Usage (%) | 66.5 | 11.8 | 80.1 | 68.2 | 79.0 |
| Tokenization (ms) | 15.0 | 10.2 | 98.8 | 11.6 | 16.0 |
| Inference (ms) | 71.6 | 44.3 | 148.9 | 72.5 | 85.8 |
| Queue Wait (ms) | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
| Padding Waste (%) | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |

## Dashboard Time-Series Data

| Index | GPU Mem (MB) | GPU Util (%) | CPU (%) | Latency (ms) | Throughput | Tokenize (ms) | Inference (ms) | Queue (ms) | Padding (%) |
|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| 0 | 1087.6 | 12.1 | 36.9 | 179.1 | 32 | 16.0 | 120.7 | 0.0 | 0.0 |
| 1 | 1087.6 | 27.0 | 35.6 | 312.3 | 64 | 15.2 | 148.9 | 0.0 | 0.0 |
| 2 | 1087.6 | 25.6 | 51.1 | 364.6 | 96 | 98.8 | 47.4 | 0.0 | 0.0 |
| 3 | 1087.6 | 17.9 | 52.9 | 330.6 | 96 | 49.4 | 71.4 | 0.0 | 0.0 |
| 4 | 1087.6 | 13.3 | 39.5 | 350.0 | 64 | 89.6 | 61.9 | 0.0 | 0.0 |
| 5 | 1111.6 | 27.0 | 77.5 | 344.6 | 96 | 11.5 | 72.3 | 0.0 | 0.0 |
| 6 | 1113.6 | 36.2 | 63.1 | 313.4 | 128 | 11.2 | 78.8 | 0.0 | 0.0 |
| 7 | 1137.6 | 30.2 | 63.3 | 287.1 | 128 | 11.1 | 74.2 | 0.0 | 0.0 |
| 8 | 1141.6 | 22.1 | 71.5 | 285.1 | 96 | 11.2 | 72.3 | 0.0 | 0.0 |
| 9 | 1141.6 | 22.9 | 72.4 | 287.8 | 96 | 11.2 | 77.2 | 0.0 | 0.0 |
| 10 | 1141.6 | 28.1 | 68.2 | 281.7 | 128 | 11.2 | 73.1 | 0.0 | 0.0 |
| 11 | 1165.6 | 26.8 | 63.6 | 278.4 | 128 | 11.1 | 68.0 | 0.0 | 0.0 |
| 12 | 1195.6 | 21.9 | 70.4 | 284.6 | 96 | 11.7 | 75.4 | 0.0 | 0.0 |
| 13 | 1195.6 | 19.9 | 80.1 | 277.6 | 96 | 11.1 | 46.6 | 0.0 | 0.0 |
| 14 | 1195.6 | 27.5 | 67.0 | 280.0 | 128 | 11.3 | 84.2 | 0.0 | 0.0 |
| 15 | 1171.6 | 29.9 | 64.0 | 286.2 | 128 | 11.1 | 71.5 | 0.0 | 0.0 |
| 16 | 1171.6 | 25.0 | 73.3 | 273.7 | 128 | 10.8 | 51.4 | 0.0 | 0.0 |
| 17 | 1141.6 | 14.7 | 71.0 | 260.2 | 96 | 11.2 | 44.7 | 0.0 | 0.0 |
| 18 | 1113.6 | 20.0 | 78.8 | 278.4 | 96 | 11.8 | 83.2 | 0.0 | 0.0 |
| 19 | 1171.6 | 21.4 | 69.2 | 283.6 | 96 | 12.2 | 80.0 | 0.0 | 0.0 |
| 20 | 1203.6 | 28.9 | 61.0 | 284.2 | 128 | 12.4 | 83.6 | 0.0 | 0.0 |
| 21 | 1177.6 | 28.2 | 69.2 | 282.3 | 128 | 11.5 | 46.3 | 0.0 | 0.0 |
| 22 | 1145.6 | 19.3 | 76.3 | 275.9 | 96 | 11.8 | 69.0 | 0.0 | 0.0 |
| 23 | 1177.6 | 19.4 | 74.8 | 276.3 | 96 | 11.1 | 71.7 | 0.0 | 0.0 |
| 24 | 1177.6 | 24.7 | 69.4 | 273.6 | 128 | 12.9 | 50.1 | 0.0 | 0.0 |
| 25 | 1177.6 | 26.2 | 65.0 | 277.1 | 128 | 10.9 | 54.1 | 0.0 | 0.0 |
| 26 | 1177.6 | 26.6 | 67.5 | 277.8 | 128 | 12.0 | 80.6 | 0.0 | 0.0 |
| 27 | 1177.6 | 20.0 | 75.3 | 278.5 | 96 | 11.6 | 74.7 | 0.0 | 0.0 |
| 28 | 1157.6 | 22.1 | 72.0 | 285.5 | 96 | 12.3 | 74.7 | 0.0 | 0.0 |
| 29 | 1157.6 | 28.0 | 65.5 | 281.8 | 128 | 12.2 | 52.7 | 0.0 | 0.0 |
| 30 | 1145.6 | 19.2 | 57.3 | 275.9 | 96 | 12.5 | 58.2 | 0.0 | 0.0 |
| 31 | 1157.6 | 27.9 | 65.1 | 326.4 | 96 | 10.8 | 66.8 | 0.0 | 0.0 |
| 32 | 1157.6 | 35.0 | 64.6 | 315.4 | 128 | 11.9 | 75.5 | 0.0 | 0.0 |
| 33 | 1129.6 | 20.0 | 65.8 | 277.8 | 96 | 10.5 | 69.5 | 0.0 | 0.0 |
| 34 | 1129.6 | 22.6 | 79.0 | 287.5 | 96 | 13.1 | 75.4 | 0.0 | 0.0 |
| 35 | 1185.6 | 20.8 | 68.9 | 281.9 | 96 | 12.9 | 77.4 | 0.0 | 0.0 |
| 36 | 1185.6 | 28.4 | 62.1 | 282.7 | 128 | 11.9 | 75.8 | 0.0 | 0.0 |
| 37 | 1185.6 | 27.6 | 67.0 | 280.3 | 128 | 11.7 | 72.9 | 0.0 | 0.0 |
| 38 | 1185.6 | 19.7 | 69.8 | 277.1 | 96 | 11.7 | 72.4 | 0.0 | 0.0 |
| 39 | 1185.6 | 20.1 | 74.9 | 278.8 | 96 | 12.1 | 76.3 | 0.0 | 0.0 |
| 40 | 1185.6 | 28.5 | 62.3 | 283.2 | 128 | 12.2 | 83.2 | 0.0 | 0.0 |
| 41 | 1185.6 | 27.7 | 70.4 | 281.5 | 128 | 11.4 | 72.1 | 0.0 | 0.0 |
| 42 | 1185.6 | 17.3 | 67.5 | 269.2 | 96 | 10.7 | 71.6 | 0.0 | 0.0 |
| 43 | 1131.6 | 18.3 | 79.9 | 271.9 | 96 | 11.4 | 59.8 | 0.0 | 0.0 |
| 44 | 1185.6 | 23.0 | 66.5 | 288.3 | 96 | 11.3 | 77.7 | 0.0 | 0.0 |
| 45 | 1185.6 | 27.7 | 71.4 | 281.1 | 128 | 10.5 | 44.3 | 0.0 | 0.0 |
| 46 | 1185.6 | 23.2 | 67.9 | 269.2 | 128 | 10.2 | 70.8 | 0.0 | 0.0 |
| 47 | 1185.6 | 23.8 | 70.9 | 270.6 | 128 | 10.9 | 69.8 | 0.0 | 0.0 |
| 48 | 1185.6 | 18.5 | 74.1 | 272.8 | 96 | 11.3 | 71.5 | 0.0 | 0.0 |
| 49 | 1185.6 | 20.1 | 75.5 | 278.6 | 96 | 11.8 | 55.6 | 0.0 | 0.0 |
| 50 | 1185.6 | 27.0 | 65.5 | 279.6 | 128 | 12.5 | 85.8 | 0.0 | 0.0 |
| 51 | 1185.6 | 24.1 | 72.7 | 271.9 | 128 | 10.7 | 51.9 | 0.0 | 0.0 |
| 52 | 1185.6 | 24.8 | 63.1 | 273.6 | 128 | 12.1 | 72.5 | 0.0 | 0.0 |
| 53 | 1131.6 | 23.1 | 76.0 | 288.9 | 96 | 11.3 | 82.9 | 0.0 | 0.0 |
| 54 | 1131.6 | 18.9 | 77.3 | 274.4 | 96 | 11.4 | 51.6 | 0.0 | 0.0 |
| 55 | 1185.6 | 25.6 | 65.3 | 275.2 | 128 | 11.2 | 74.0 | 0.0 | 0.0 |
| 56 | 1185.6 | 27.5 | 66.2 | 280.4 | 128 | 12.5 | 76.5 | 0.0 | 0.0 |
| 57 | 1185.6 | 20.1 | 62.2 | 279.3 | 96 | 12.1 | 76.2 | 0.0 | 0.0 |
| 58 | 1185.6 | 21.0 | 79.9 | 282.0 | 96 | 11.6 | 76.6 | 0.0 | 0.0 |
| 59 | 1185.6 | 21.6 | 70.0 | 283.8 | 96 | 11.2 | 87.1 | 0.0 | 0.0 |
| 60 | 1185.6 | 29.4 | 11.8 | 285.3 | 128 | 12.6 | 77.3 | 0.0 | 0.0 |
