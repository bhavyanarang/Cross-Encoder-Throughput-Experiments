# 06a_concurrency_mps

_Sweep concurrency levels on MPS backend_

**Timestamp:** 2025-12-26 02:19:43

**Model:** `cross-encoder/ms-marco-MiniLM-L-6-v2`

**Backend:** `mps` | **Device:** `mps`

## Results Summary

| Batch | Conc | Pairs | Time(s) | Lat Avg | Lat P95 | Lat P99 | TP Avg | TP P95 |
|-------|------|-------|---------|---------|---------|---------|--------|--------|
| 96 | 1 | 9600 | 14.32 | 143.1ms | 201.6ms | 263.0ms | 670.6 | 870.5 |

## Detailed Metrics

### Config 1: batch=96, concurrency=1

**Total:** 9600 pairs in 14.32s

#### Latency (ms)
| Metric | Value |
|--------|-------|
| Average | 143.13 |
| Min | 107.82 |
| Max | 398.38 |
| Std Dev | 37.45 |
| P50 | 135.72 |
| P90 | 173.65 |
| P95 | 201.64 |
| P99 | 262.99 |

#### Throughput (pairs/s)
| Metric | Value |
|--------|-------|
| Average | 670.55 |
| Min | 240.97 |
| Max | 890.39 |
| Std Dev | 121.60 |
| P50 | 707.35 |
| P90 | 845.43 |
| P95 | 870.46 |
| P99 | 886.06 |

#### Latency vs Throughput Analysis

| Latency Range | Avg Throughput | Min Throughput | Max Throughput | Count |
|---------------|----------------|----------------|----------------|-------|
| < 135.7ms (P50) | 793.20 | 708.38 | 890.39 | 50 |
| 135.7-153.5ms (P50-P75) | 674.09 | 625.86 | 706.31 | 25 |
| 153.5-173.7ms (P75-P90) | 596.80 | 553.36 | 624.32 | 15 |
| >= 173.7ms (P90+) | 450.54 | 240.97 | 548.07 | 10 |

**Correlation:** -0.911 (negative correlation expected: lower latency = higher throughput)

## Overall Summary

| Metric | Value | Config |
|--------|-------|--------|
| Best Throughput | 670.55 p/s | batch=96, conc=1 |
| Best Latency | 143.13ms | batch=96, conc=1 |
| Avg Throughput | 670.55 p/s | all configs |
| Avg Latency | 143.13ms | all configs |

## Dashboard Metrics Summary

| Metric | Avg | Min | Max | P50 | P95 |
|--------|-----|-----|-----|-----|-----|
| GPU Memory (MB) | 2473.7 | 1137.6 | 2627.6 | 2627.6 | 2627.6 |
| GPU Utilization (%) | 71.4 | 29.1 | 92.9 | 71.4 | 85.2 |
| CPU Usage (%) | 1.0 | 0.7 | 1.6 | 1.0 | 1.5 |
| Tokenization (ms) | 33.3 | 29.7 | 42.5 | 32.7 | 37.0 |
| Inference (ms) | 95.7 | 75.1 | 135.6 | 94.0 | 128.0 |
| Queue Wait (ms) | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
| Padding Waste (%) | 45.2 | 38.8 | 54.6 | 44.3 | 51.5 |

## Dashboard Time-Series Data

| Index | GPU Mem (MB) | GPU Util (%) | CPU (%) | Latency (ms) | Throughput | Tokenize (ms) | Inference (ms) | Queue (ms) | Padding (%) |
|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| 0 | 1137.6 | 29.1 | 1.5 | 178.8 | 192 | 32.1 | 75.1 | 0.0 | 42.6 |
| 1 | 1379.6 | 69.4 | 0.9 | 144.1 | 672 | 33.4 | 131.1 | 0.0 | 47.6 |
| 2 | 1483.6 | 75.4 | 0.9 | 141.4 | 672 | 33.1 | 81.6 | 0.0 | 41.9 |
| 3 | 2627.6 | 61.2 | 0.7 | 135.7 | 576 | 32.8 | 108.6 | 0.0 | 44.0 |
| 4 | 2627.6 | 92.9 | 0.7 | 189.3 | 576 | 31.5 | 99.8 | 0.0 | 42.3 |
| 5 | 2627.6 | 85.2 | 0.9 | 156.8 | 672 | 30.8 | 79.5 | 0.0 | 42.2 |
| 6 | 2627.6 | 85.0 | 1.4 | 156.2 | 672 | 32.4 | 107.1 | 0.0 | 44.6 |
| 7 | 2627.6 | 75.0 | 1.6 | 145.1 | 672 | 34.5 | 95.4 | 0.0 | 47.5 |
| 8 | 2627.6 | 66.0 | 0.9 | 149.7 | 576 | 32.7 | 88.4 | 0.0 | 44.7 |
| 9 | 2627.6 | 74.5 | 0.9 | 165.0 | 576 | 37.4 | 135.6 | 0.0 | 51.0 |
| 10 | 2627.6 | 77.3 | 1.1 | 149.4 | 672 | 34.2 | 103.9 | 0.0 | 42.3 |
| 11 | 2627.6 | 66.8 | 1.0 | 138.1 | 672 | 32.7 | 118.9 | 0.0 | 51.6 |
| 12 | 2627.6 | 73.8 | 0.9 | 148.3 | 672 | 31.0 | 77.3 | 0.0 | 43.4 |
| 13 | 2627.6 | 76.1 | 1.0 | 128.6 | 768 | 32.6 | 80.7 | 0.0 | 38.8 |
| 14 | 2627.6 | 67.9 | 1.1 | 117.6 | 768 | 30.3 | 79.2 | 0.0 | 39.6 |
| 15 | 2627.6 | 70.2 | 1.0 | 121.5 | 768 | 34.6 | 76.4 | 0.0 | 42.6 |
| 16 | 2507.6 | 70.7 | 0.8 | 122.9 | 768 | 34.5 | 96.5 | 0.0 | 42.3 |
| 17 | 2627.6 | 76.0 | 0.9 | 129.6 | 768 | 32.7 | 83.0 | 0.0 | 40.8 |
| 18 | 2627.6 | 78.4 | 1.1 | 133.1 | 768 | 33.9 | 113.2 | 0.0 | 54.6 |
| 19 | 2627.6 | 66.0 | 1.0 | 129.6 | 672 | 33.6 | 97.5 | 0.0 | 46.5 |
| 20 | 2627.6 | 65.1 | 1.1 | 129.4 | 672 | 42.5 | 92.6 | 0.0 | 46.9 |
| 21 | 2627.6 | 70.1 | 0.9 | 151.4 | 672 | 35.8 | 102.5 | 0.0 | 49.6 |
| 22 | 2627.6 | 63.3 | 1.1 | 162.6 | 576 | 34.3 | 104.0 | 0.0 | 50.2 |
| 23 | 2627.6 | 68.2 | 1.2 | 141.8 | 672 | 31.7 | 91.9 | 0.0 | 47.2 |
| 24 | 2627.6 | 72.1 | 1.1 | 128.7 | 768 | 31.0 | 81.7 | 0.0 | 41.4 |
| 25 | 2627.6 | 80.2 | 1.3 | 122.4 | 864 | 29.7 | 87.3 | 0.0 | 48.1 |
